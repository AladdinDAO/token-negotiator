(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{10:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(5),i=a(6),r=a(2),o=a(3),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(n.a)(this,e),"string"==typeof t)throw new TypeError("Unimplemented: Not accepting string yet.");if(t instanceof ArrayBuffer){var a=fromBER(t);this.fromSchema(a.result)}else this.algorithmId=Object(o.getParametersValue)(t,"algorithmId"),"algorithmParams"in t&&(this.algorithmParams=Object(o.getParametersValue)(t,"algorithmParams",e.defaultValues("algorithmParams")))}return Object(i.a)(e,[{key:"fromSchema",value:function(t){Object(o.clearProps)(t,["algorithm","params"]);var a=Object(r.compareSchema)(t,t,e.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(!1===a.verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=a.result.algorithm.valueBlock.toString(),"params"in a.result&&(this.algorithmParams=a.result.params)}},{key:"toSchema",value:function(){var e=[];return e.push(new r.ObjectIdentifier({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof asn1js.Any===!1&&e.push(this.algorithmParams),new r.Sequence({value:e})}},{key:"toJSON",value:function(){var e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof asn1js.Any===!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}},{key:"isEqual",value:function(t){return t instanceof e!==!1&&(this.algorithmId===t.algorithmId&&("algorithmParams"in this?"algorithmParams"in t&&JSON.stringify(this.algorithmParams)===JSON.stringify(t.algorithmParams):!("algorithmParams"in t)))}}],[{key:"defaultValues",value:function(e){switch(e){case"algorithmParams":return new r.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: ".concat(e))}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof asn1js.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: ".concat(e))}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.getParametersValue)(e,"names",{});return new r.Sequence({name:t.blockName||"",optional:t.optional||!1,value:[new r.ObjectIdentifier({name:t.algorithmIdentifier||"algorithm"}),new r.Any({name:t.algorithmParams||"parameters",optional:!0})]})}}]),e}(),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(n.a)(this,e),"string"==typeof t)throw new TypeError("Not accepting string. For base64, convert to ArrayBuffer.");if(t instanceof ArrayBuffer){var a=Object(r.fromBER)(t);this.fromSchema(a.result)}else this.signatureAlgorithm=Object(o.getParametersValue)(t,"signatureAlgorithm"),this.publicKey=Object(o.getParametersValue)(t,"publicKey")}return Object(i.a)(e,[{key:"fromSchema",value:function(t){if(Object(o.clearProps)(t,["signatureAlgorithm","publicKey"]),!1===Object(r.compareSchema)(t,t,e.schema({names:{signatureAlgorithm:"signatureAlgorithm",publicKey:"publicKey"}})).verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier")}}],[{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.getParametersValue)(e,"names",{});return new r.Sequence({name:t.blockName||"",optional:!0,value:[s.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new r.BitString({name:"publicKey"})]})}}]),e}()},15:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var n=a(5),i=a(6),r=a(16),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(n.a)(this,t),a.attestationOrigin||console.log("no attestation origin provided"),a.tokenOrigin||console.log("no tokenOrigin provided");var i={attestationOrigin:a.attestationOrigin,tokenOrigin:a.tokenOrigin,tokenUrlName:"ticket",tokenSecretName:"secret",unsignedTokenDataName:"ticket",tokenParserUrl:"",tokenParser:r.a,localStorageItemName:"dcTokens"};if(this.queuedCommand=!1,this.filter=e,this.debug=0,this.hideTokensIframe=1,this.tokenOrigin=i.tokenOrigin,this.attestationOrigin=i.attestationOrigin,this.tokenUrlName=i.tokenUrlName,this.tokenSecretName=i.tokenSecretName,this.unsignedTokenDataName=i.unsignedTokenDataName,this.tokenParser=i.tokenParser,this.localStorageItemName=i.localStorageItemName,a.hasOwnProperty("debug")&&(this.debug=a.debug),a.hasOwnProperty("attestationOrigin")&&(this.attestationOrigin=a.attestationOrigin),a.hasOwnProperty("tokenOrigin")&&(this.tokenOrigin=a.tokenOrigin),this.isTokenOriginWebsite=!1,this.attestationOrigin){var o=new URL(window.location.href),s=new URL(this.tokenOrigin);o.origin===s.origin&&(console.log("this is tokenOrigin. fire listener and read params"),this.isTokenOriginWebsite=!0,this.readMagicUrl())}if(window!==window.parent){this.debug&&console.log("negotiator: its iframe, lets return tokens to the parent"),this.attachPostMessageListener(this.listenForParentMessages.bind(this));var c=new URL(document.referrer);window.parent.postMessage({iframeCommand:"iframeReady",iframeData:""},c.origin)}}return Object(i.a)(t,[{key:"listenForParentMessages",value:function(e){var t=new URL(document.referrer);if(e.origin===t.origin&&"undefined"!==typeof e.data.parentCommand&&"undefined"!==typeof e.data.parentData){var a=e.data.parentCommand,n=e.data.parentData;switch(console.log("iframe: command, data = ",a,n),a){case"signToken":if(console.log("let Auth data:",n),"undefined"===typeof window.Authenticator)return void console.log("Authenticator not defined.");var i=this.getRawToken(n),r=i.token,o=i.secret;this.authenticator=new Authenticator(this),this.authenticator.getAuthenticationBlob({ticketBlob:r,ticketSecret:o,attestationOrigin:this.attestationOrigin},(function(e){console.log("sign result:",e),window.parent.postMessage({iframeCommand:"useTokenData",iframeData:{useToken:e,message:"",success:!!e}},t.origin)}));break;case"tokensList":console.log("let return tokens"),this.returnTokensToParent()}}}},{key:"commandDisplayIframe",value:function(){var e=new URL(document.referrer);window.parent.postMessage({iframeCommand:"iframeWrap",iframeData:"show"},e.origin)}},{key:"commandHideIframe",value:function(){var e=new URL(document.referrer);window.parent.postMessage({iframeCommand:"iframeWrap",iframeData:"hide"},e.origin)}},{key:"returnTokensToParent",value:function(){var e=this.readTokens();if(e.success&&!e.noTokens){var t=this.decodeTokens(e.tokens),a=this.filterTokens(t);e.tokens=a}var n=new URL(document.referrer);window.parent.postMessage({iframeCommand:"tokensData",iframeData:e},n.origin)}},{key:"readMagicUrl",value:function(){var e=new URLSearchParams(window.location.search),t=e.get(this.tokenUrlName),a=e.get(this.tokenSecretName);if(t&&a){var n=this.readTokens(),i=[],r=!0;n.noTokens||(i=n.tokens).map((function(e){e.token===t&&(r=!1)})),r&&i.push({token:t,secret:a}),localStorage.setItem(this.localStorageItemName,JSON.stringify(i))}}},{key:"filterTokens",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};0==Object.keys(a).length&&(a=this.filter);var n=[];if(e.length&&"object"===typeof a&&Object.keys(a).length){var i=Object.keys(a);return e.forEach((function(e){var r=1;t.debug&&console.log("test token:",e),i.forEach((function(t){e[t].toString()!=a[t].toString()&&(r=0)})),r&&(n.push(e),t.debug&&console.log("token fits:",e))})),n}return e}},{key:"compareObjects",value:function(e,t){for(var a in e)if(e.hasOwnProperty(a)&&e[a].toString()!==t[a].toString())return!1;for(var a in t)if(t.hasOwnProperty(a)&&e[a].toString()!==t[a].toString())return!1;return!0}},{key:"readTokens",value:function(){var e=localStorage.getItem(this.localStorageItemName),t=[],a={tokens:[],noTokens:!0,success:!0};try{e&&e.length&&(0!==(t=JSON.parse(e)).length&&t.forEach((function(e){e.token&&e.secret&&a.tokens.push({token:e.token,secret:e.secret})})),a.tokens.length&&(a.noTokens=!1))}catch(n){console.log("Cant parse tokens in LocalStorage"),"function"===typeof callBack&&(a.success=!1)}return a}},{key:"getRawToken",value:function(e){var t=this,a=this.readTokens();if(a.success&&!a.noTokens){var n=a.tokens,i=!1;return n.length&&n.forEach((function(a){if(a.token){var n=new t.tokenParser(t.base64ToUint8array(a.token).buffer);if(n&&n[t.unsignedTokenDataName]){var r=n[t.unsignedTokenDataName];t.compareObjects(r,e)&&(i=a)}}else console.log("empty token data received")})),i}}},{key:"listenForIframeMessages",value:function(e){var t=new URL(this.tokenOrigin);if(e.origin===t.origin&&"undefined"!==typeof e.data.iframeCommand&&"undefined"!==typeof e.data.iframeData){var a=e.data.iframeCommand,n=e.data.iframeData;switch(console.log("parent: command, data = ",a,n),a){case"iframeWrap":"show"==n?this.tokenIframeWrap.style.display="block":"hide"==n&&(this.tokenIframeWrap.style.display="none");break;case"tokensData":this.detachPostMessageListener(this.listenForIframeMessages),this.tokenIframeWrap.remove(),n.success&&!n.noTokens&&(n.tokens=this.filterTokens(n.tokens)),this.negotiateCallback(n);break;case"useTokenData":this.tokenIframeWrap.remove(),console.log("this.signCallback(data)"),this.signCallback&&this.signCallback(n),this.signCallback=!1;break;case"iframeReady":e.source.postMessage(this.queuedCommand,e.origin),this.queuedCommand=""}}}},{key:"signToken",value:function(e,t){this.signCallback=t,this.queuedCommand={parentCommand:"signToken",parentData:e},this.createIframe()}},{key:"getTokenInstances",value:function(e){if("function"!==typeof e)return!1;if(console.log("negotiateCallback added;"),this.negotiateCallback=e,console.log("attestationOrigin = "+this.attestationOrigin),this.attestationOrigin)if(window.location.href===this.tokenOrigin){var t=this.readTokens();if(t.success&&!t.noTokens){var a=this.decodeTokens(t.tokens),n=this.filterTokens(a);t.tokens=n,this.negotiateCallback(t)}}else this.queuedCommand={parentCommand:"tokensList",parentData:""},this.createIframe();else console.log("no attestationOrigin"),this.negotiateCallback([])}},{key:"createIframe",value:function(){console.log("open iframe"),this.attachPostMessageListener(this.listenForIframeMessages.bind(this));var e=document.createElement("iframe");this.iframe=e,e.src=this.tokenOrigin,e.style.width="800px",e.style.height="700px",e.style.maxWidth="100%",e.style.background="#fff";var t=document.createElement("div");this.tokenIframeWrap=t,t.setAttribute("style","width:100%; min-height: 100vh; position: fixed; align-items: center; justify-content: center; display: none; top: 0; left: 0; background: #fffa"),t.appendChild(e),document.body.appendChild(t)}},{key:"base64ToUint8array",value:function(t){return t=t.split("-").join("+").split("_").join("/").split(".").join("="),"undefined"!==typeof e?Uint8Array.from(e.from(t,"base64")):Uint8Array.from(atob(t),(function(e){return e.charCodeAt(0)}))}},{key:"decodeTokens",value:function(e){var t=this;this.debug&&(console.log("decodeTokens fired"),console.log(e));var a=[];return e.length&&e.forEach((function(e){if(e.token){var n=new t.tokenParser(t.base64ToUint8array(e.token).buffer);n&&n[t.unsignedTokenDataName]&&a.push(n[t.unsignedTokenDataName])}else console.log("empty token data received")})),a}},{key:"attachPostMessageListener",value:function(e){window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e)}},{key:"detachPostMessageListener",value:function(e){window.addEventListener?window.removeEventListener("message",e,!1):window.detachEvent("onmessage",e)}}]),t}()}).call(this,a(13).Buffer)},16:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var n=a(5),i=a(6),r=a(2),o=a(3),s=a(10),c=a(9),l=a.n(c),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(n.a)(this,e),"string"==typeof t)throw new TypeError("Unimplemented: Not accepting string yet.");if(t instanceof ArrayBuffer){var a=Object(r.fromBER)(t);this.fromSchema(a.result)}else this.devconId=Object(o.getParametersValue)(t,"devconId"),this.ticketId=Object(o.getParametersValue)(t,"ticketId"),this.ticketClass=Object(o.getParametersValue)(t,"ticketClass")}return Object(i.a)(e,[{key:"fromSchema",value:function(t){Object(o.clearProps)(t,["devconId","ticketId","ticketClass"]);var a=Object(r.compareSchema)(t,t,e.schema());if(!1===a.verified)throw new Error("Object's schema was not verified against input data for DevconTicket");if("devconId"in a.result){var n=a.result.devconId.valueBlock._valueHex;this.devconId=new l.a("0x"+Object(o.bufferToHexCodes)(n)).value}if("ticketId"in a.result){var i=a.result.ticketId.valueBlock._valueHex;this.ticketId=new l.a("0x"+Object(o.bufferToHexCodes)(i)).value}if("ticketClass"in a.result){var s=a.result.ticketClass.valueBlock._valueHex;this.ticketClass=new l.a("0x"+Object(o.bufferToHexCodes)(s)).value}}}],[{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.getParametersValue)(e,"names",{});return new r.Sequence({name:t.blockName||"ticket",value:[new r.Integer({name:t.devconId||"devconId"}),new r.Integer({name:t.ticketId||"ticketId"}),new r.Integer({name:t.ticketClass||"ticketClass"})]})}}]),e}(),u=function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(n.a)(this,t),"string"==typeof a){var i=a.startsWith("https://")?new URL(a).searchParams.get("ticket"):a,c=i.split("_").join("+").split("-").join("/").split(".").join("=");a="undefined"!==typeof e?Uint8Array.from(e.from(c,"base64")).buffer:Uint8Array.from(atob(c),(function(e){return e.charCodeAt(0)})).buffer}if(a instanceof ArrayBuffer){var l=Object(r.fromBER)(a);this.fromSchema(l.result)}else this.ticket=new m(a.ticket),this.commitment=Object(o.getParametersValue)(a,"commitment"),this.publicKeyInfo=new s.a(a.publicKeyInfo),this.signatureValue=Object(o.getParametersValue)(a,"signatureValue")}return Object(i.a)(t,[{key:"fromSchema",value:function(e){Object(o.clearProps)(e,["ticket","commitment","publicKeyInfo","signatureValue"]);var a=Object(r.compareSchema)(e,e,t.schema());if(!1===a.verified)throw new Error("Object's schema was not verified against input data for SignedDevconTicket");this.ticket=new m(a.result.ticket.valueBeforeDecode),"commitment"in a.result&&(this.commitment=a.result.commitment.valueBlock.valueHex),this.publicKeyInfo=new s.a({schema:a.result.publicKeyInfo});var n=a.result.signatureValue;this.signatureValue=n.valueBlock.valueHex}}],[{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.getParametersValue)(e,"names",{});return new r.Sequence({name:t.blockName||"SignedDevconTicket",value:[m.schema(e),new r.OctetString({name:"commitment"}),new r.Sequence({name:"publicKeyInfo",optional:!0,value:[s.a.schema(t.publicKeyInfo||{names:{blockName:"publicKeyInfo"}})]}),new r.BitString({name:"signatureValue"})]})}}]),t}()}).call(this,a(13).Buffer)},25:function(e,t,a){},40:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(1),r=a.n(i),o=a(14),s=a.n(o),c=(a(25),a(18)),l=a(15),m=a(58);a(40);var u=function(e){var t=e.tokenInstance;return Object(n.jsxs)("div",{className:"ticketContainer",children:[Object(n.jsxs)("div",{className:"ticketDetails",children:[Object(n.jsx)(m.a,{className:"ticketClass",gutterBottom:!0,variant:"h5",component:"h2",children:t.ticketClass.toString()}),Object(n.jsx)(m.a,{className:"ticketId",variant:"body2",color:"textSecondary",component:"p",children:t.ticketId.toString()}),Object(n.jsxs)(m.a,{className:"devconId",variant:"body2",color:"textSecondary",component:"p",children:["Devcon ID: ",t.devconId.toString()]})]}),Object(n.jsx)("img",{className:"ticketImg",src:"ticket_example_image.svg"})]})};a(45);var h=function(){var e=Object(i.useState)([]),t=Object(c.a)(e,2),a=t[0],r=t[1],o=new l.a({},{attestationOrigin:"https://stage.attestation.id",tokenOrigin:"https://tokenscript.github.io/token-negotiator/examples/ticket-issuer/build/index.html"});return Object(i.useEffect)((function(){o.getTokenInstances((function(e){e.success&&r(e.tokens)}))}),[]),Object(n.jsxs)("main",{className:"pageStyles",children:[Object(n.jsx)("a",{href:"/",children:Object(n.jsx)("img",{className:"logo",src:"./devcon.svg"})}),Object(n.jsx)("div",{className:"flexCenter",children:Object(n.jsx)("p",{children:"[DEMO Ticket Issuer Website]"})}),Object(n.jsx)("div",{className:"flexCenter",children:Object(n.jsx)("img",{className:"devcon_bogota",src:"./devcon_bogota.svg"})}),Object(n.jsx)("div",{className:"flexCenter",children:Object(n.jsx)("p",{children:"A Devcon ticket provides access to the event and special offers between the dates X-XX for hotel bookings, travel, restaurants and more."})}),Object(n.jsx)("div",{className:"flexCenter",children:Object(n.jsx)("p",{children:"Your tickets:"})}),Object(n.jsx)("div",{className:"flexCenter",children:Object(n.jsxs)("div",{className:"tokensWrapper",children:[a&&a.length>0&&a.map((function(e,t){return Object(n.jsx)(u,{tokenInstance:e},t)})),!a.length&&Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"- no ticket found -"}),Object(n.jsxs)("p",{children:["Click ",Object(n.jsx)("a",{href:"?ticket=MIGbMA0CAQYCBWE3ap3-AgEABEEEKJZVxMEXbkSZZBWnNUTX_5ieu8GUqf0bx_a0tBPF6QYskABaMJBYhDOXsmQt3csk_TfMZ2wdmfRkK7ePCOI2kgNHADBEAiBwLK_95NPZo0W01HDBfyZisZ2KaNrzoWuxRV-nhjGLMAIgaOP4eVVINH5xM8Cv9OVDdyOG3BxUqyPVQOuDU9PaC9o=&secret=45845870684",children:"here"})," to generate a ticket (for demo purposes only)."]}),Object(n.jsxs)("p",{children:["Click ",Object(n.jsx)("a",{href:"?ticket=MIGYMAoCAQYCAgFNAgECBEEEKJZVxMEXbkSZZBWnNUTX_5ieu8GUqf0bx_a0tBPF6QYskABaMJBYhDOXsmQt3csk_TfMZ2wdmfRkK7ePCOI2kgNHADBEAiB4thME54fWjTs1eJ5XseTPk7sqOUa9JzVsDMURBwTlJwIgChH-eU6seNnC8hVDgBvLvUJPpGWviWsQ2WwWrcC7Meg=&secret=45845870684",children:"here"})," to generate a ticket (for demo purposes only)."]}),Object(n.jsxs)("p",{children:["Click ",Object(n.jsx)("a",{href:"?ticket=MIGZMAoCAQYCAgDeAgEBBEEEKJZVxMEXbkSZZBWnNUTX_5ieu8GUqf0bx_a0tBPF6QYskABaMJBYhDOXsmQt3csk_TfMZ2wdmfRkK7ePCOI2kgNIADBFAiEAy0hGTGFw_KWyk0EbDFI7y4x8LaplJ6PEPFDb-AQ82GUCIEKP4650eRZyvbgNbTcnjRLaRthc4oIFEn7FVS2nNJ6o&secret=45845870684",children:"here"})," to generate a ticket (for demo purposes only)."]}),Object(n.jsxs)("p",{children:["Click ",Object(n.jsx)("a",{href:"?ticket=MIGXMAkCAQYCAW8CAQAEQQQollXEwRduRJlkFac1RNf_mJ67wZSp_RvH9rS0E8XpBiyQAFowkFiEM5eyZC3dyyT9N8xnbB2Z9GQrt48I4jaSA0cAMEQCIFavePjptmgxBsVuHp7bZSDxK0ovB8d9URp2VjiGos56AiA9apKTL6Kk74Jgf2H7Mb4EZqlsdwJLXSN23sC6aoRyKg==&secret=45845870684",children:"here"})," to generate a ticket (for demo purposes only)."]})]})]})})]})},f=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,59)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),n(e),i(e),r(e),o(e)}))};s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(h,{})}),document.getElementById("root")),f()}},[[46,1,2]]]);
//# sourceMappingURL=main.765c4b39.chunk.js.map